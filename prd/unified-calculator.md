# 통합 수입원가 계산기 PRD (Product Requirements Document)

## 문서 정보
- **작성일**: 2026-01-20
- **버전**: 1.0
- **상태**: 기획 완료

---

## 1. 개요

### 1.1 프로젝트 목적
현재 탭으로 분리된 "환율 계산기"와 "수입원가 계산기"를 하나의 수직 스크롤 페이지로 통합

### 1.2 해결하려는 문제
- 기존: 환율 계산과 수입원가 계산이 별도 탭으로 분리
- 문제: 사용자가 탭을 전환하며 정보를 확인해야 함
- 개선: 하나의 페이지에서 환율 확인부터 최종 원가 계산까지 완료

### 1.3 핵심 기능
1. 실시간 환율 표시 (USD/CNY)
2. HS Code 품목 검색 및 관세율 조회
3. 개당 원가와 수량 입력
4. 기본세율 vs FTA 세율 비교 결과 표시
5. FTA 적용 시 절감액 표시

---

## 2. 입력 변수

### 2.1 데이터 입력 항목

| 변수명 | 설명 | 입력 방식 | 예시 |
|--------|------|----------|------|
| 품목 | HS Code 또는 제품명 | 검색 + 자동완성 | "장갑", "6116100000" |
| 개당 원가 | 제품 1개 가격 (CNY) | 숫자 입력 | 100 |
| 수량 | 수입 수량 (개) | 숫자 입력 | 1,000 |

### 2.2 자동 연동 데이터

| 데이터 | 출처 | 설명 |
|--------|------|------|
| 환율 (CNY/KRW) | 한국수출입은행 API | 실시간 매매기준율 |
| 기본세율 | HS Code 데이터 | 품목별 기본 관세율 |
| FTA 세율 | HS Code 데이터 | 한중 FTA 협정 관세율 |

---

## 3. 계산 로직

### 3.1 계산 공식

```
[입력값]
unitPrice   = 개당 원가 (CNY)
quantity    = 수량 (개)
exchangeRate = 환율 (CNY -> KRW)
basicRate   = 기본세율 (%)
ftaRate     = 한중 FTA 세율 (%)

[1단계: 총 제품가격 계산]
totalCNY = unitPrice x quantity
totalKRW = totalCNY x exchangeRate

[2단계: 기본세율 적용]
basicTariff   = totalKRW x (basicRate / 100)
basicTaxable  = totalKRW + basicTariff
basicVat      = basicTaxable x 0.10
basicTotal    = basicTaxable + basicVat

[3단계: FTA 세율 적용]
ftaTariff     = totalKRW x (ftaRate / 100)
ftaTaxable    = totalKRW + ftaTariff
ftaVat        = ftaTaxable x 0.10
ftaTotal      = ftaTaxable + ftaVat

[4단계: 절감액 계산]
savings = basicTotal - ftaTotal
```

### 3.2 계산 예시

| 항목 | 입력값 |
|------|--------|
| 품목 | 편물제 장갑 (6116100000) |
| 개당 원가 | 100 CNY |
| 수량 | 1,000개 |
| 환율 | 190원/CNY |
| 기본세율 | 8% |
| FTA 세율 | 0% |

| 항목 | 기본세율 적용 | FTA 적용 |
|------|--------------|---------|
| 총 제품가격 | 19,000,000원 | 19,000,000원 |
| 관세 | 1,520,000원 | 0원 |
| 과세가격 | 20,520,000원 | 19,000,000원 |
| 부가세 (10%) | 2,052,000원 | 1,900,000원 |
| **총 수입원가** | **22,572,000원** | **20,900,000원** |
| **절감액** | - | **1,672,000원** |

---

## 4. UI 설계

### 4.1 전체 레이아웃 (수직 스크롤)

```
+-------------------------------------------------------------+
|  [HEADER]                                                   |
|  중국 수입원가 계산기                                         |
|  실시간 환율로 수입 비용을 한번에 계산                          |
+-------------------------------------------------------------+
|                                                             |
|  [SECTION 1: 오늘의 환율]                     [REFRESH BTN]  |
|  +------------------------+------------------------+        |
|  | [USD ICON] USD         | [CNY ICON] CNY         |        |
|  | 1,350원                | 190원                  |        |
|  +------------------------+------------------------+        |
|                                                             |
+-------------------------------------------------------------+
|                                                             |
|  [SECTION 2: 품목 검색]                                      |
|  +-------------------------------------------------------+  |
|  | [SEARCH ICON] 제품명 또는 HS Code 입력...              |  |
|  +-------------------------------------------------------+  |
|                                                             |
|  [선택된 품목]                                               |
|  +-------------------------------------------------------+  |
|  | 6116100000 편물제 장갑                         [X BTN] |  |
|  | 기본세율: 8%  |  한중 FTA: 0%                          |  |
|  +-------------------------------------------------------+  |
|                                                             |
+-------------------------------------------------------------+
|                                                             |
|  [SECTION 3: 제품 정보 입력]                                 |
|                                                             |
|  개당 원가 (CNY)               수량                         |
|  +------------------+         +------------------+          |
|  | [CNY] 100        |         | 1,000 개         |          |
|  +------------------+         +------------------+          |
|                                                             |
|  총 제품가격: CNY 100,000 -> KRW 19,000,000                 |
|  (1 CNY = 190원)                                            |
|                                                             |
+-------------------------------------------------------------+
|                                                             |
|  [SECTION 4: 계산 결과 비교]                                 |
|                                                             |
|  +------------------------+------------------------+        |
|  |   기본세율 적용         |   한중 FTA 적용 [CHECK] |        |
|  +------------------------+------------------------+        |
|  | 제품가격  19,000,000원  | 제품가격  19,000,000원 |        |
|  | 관세(8%)  1,520,000원   | 관세(0%)  0원         |        |
|  | 과세가격  20,520,000원  | 과세가격  19,000,000원 |        |
|  | 부가세    2,052,000원   | 부가세    1,900,000원 |        |
|  +------------------------+------------------------+        |
|  | 총액     22,572,000원   | 총액     20,900,000원 |        |
|  +------------------------+------------------------+        |
|                                                             |
|  +-------------------------------------------------------+  |
|  |  [CHECK ICON] 한중 FTA 적용 시 1,672,000원 절감!       |  |
|  +-------------------------------------------------------+  |
|                                                             |
+-------------------------------------------------------------+
```

### 4.2 섹션별 컴포넌트

| 섹션 | 컴포넌트 | 설명 |
|------|----------|------|
| 환율 | ExchangeRateCard | USD/CNY 환율 카드 2개 나란히 표시 |
| 품목 검색 | HsCodeSearch | 검색창 + 자동완성 + 선택 카드 |
| 입력 | ProductInput | 원가 입력 + 수량 입력 + 자동 계산 |
| 결과 | ComparisonResult | 2열 비교 테이블 + 절감액 강조 |

### 4.3 아이콘 사용 규칙

| 위치 | 아이콘 | 라이브러리 |
|------|--------|-----------|
| 환율 새로고침 | RefreshCw | lucide-react |
| 검색창 | Search | lucide-react |
| 품목 삭제 | X | lucide-react |
| FTA 체크 | Check | lucide-react |
| 정보 안내 | Info | lucide-react |

**규칙**: 이모지 사용 금지, Lucide 단색 아이콘만 사용

---

## 5. 사용자 플로우

### 5.1 기본 플로우

```
[START]
   |
   v
[환율 확인] --> 자동 로드 (페이지 진입 시)
   |
   v
[품목 검색] --> 제품명 또는 HS Code 입력
   |
   v
[품목 선택] --> 검색 결과에서 클릭
   |
   v
[원가 입력] --> 개당 원가 (CNY) 입력
   |
   v
[수량 입력] --> 수량 입력
   |
   v
[결과 확인] --> 자동 계산 (기본세율 vs FTA)
   |
   v
[END]
```

### 5.2 상태 변화

| 단계 | 상태 | 표시 내용 |
|------|------|----------|
| 초기 | 환율만 로드 | 환율 카드만 표시 |
| 품목 미선택 | 검색 대기 | "품목을 검색해주세요" |
| 품목 선택 완료 | 입력 대기 | 품목 카드 + 입력 필드 |
| 입력 완료 | 계산 완료 | 비교 결과 테이블 표시 |

---

## 6. 데이터 구조

### 6.1 상태 관리 (State)

```typescript
interface CalculatorState {
  // 환율 정보
  exchangeRates: {
    USD: number
    CNY: number
  } | null

  // 선택된 품목
  selectedItem: {
    code: string
    nameKo: string
    basicRate: number
    ftaRate: number | null
  } | null

  // 입력값
  unitPrice: number      // 개당 원가 (CNY)
  quantity: number       // 수량

  // 로딩/에러 상태
  isLoading: boolean
  error: string | null
}
```

### 6.2 계산 결과 타입

```typescript
interface CalculationResult {
  // 공통
  totalPriceCNY: number     // 총 제품가격 (CNY)
  totalPriceKRW: number     // 총 제품가격 (KRW)

  // 기본세율 적용
  basic: {
    tariffRate: number      // 세율 (%)
    tariffAmount: number    // 관세액
    taxablePrice: number    // 과세가격
    vatAmount: number       // 부가세
    totalCost: number       // 총 수입원가
  }

  // FTA 적용
  fta: {
    tariffRate: number
    tariffAmount: number
    taxablePrice: number
    vatAmount: number
    totalCost: number
  }

  // 비교
  savings: number           // 절감액
}
```

---

## 7. 파일 구조

### 7.1 신규 생성 파일

```
src/
+-- components/
|   +-- UnifiedCalculator.tsx     # 통합 계산기 메인 컴포넌트
|
+-- app/
    +-- page.tsx                  # 수정: 탭 제거, 통합 컴포넌트 사용
```

### 7.2 기존 파일 (재사용)

```
src/
+-- hooks/
|   +-- useExchangeRate.ts        # 환율 조회 훅
|   +-- useTariffSearch.ts        # 관세 검색 훅
|
+-- types/
|   +-- exchange.ts               # 환율 타입
|   +-- tariff.ts                 # 관세 타입
|
+-- app/api/
    +-- exchange-rate/route.ts    # 환율 API
    +-- tariff/search/route.ts    # 관세 검색 API
    +-- tariff/rate/route.ts      # 관세율 조회 API
```

---

## 8. 검증 계획

### 8.1 기능 테스트

- [ ] 페이지 접속 시 환율 자동 로드
- [ ] 품목 검색 (한글/영문/코드)
- [ ] 품목 선택 및 세율 표시
- [ ] 원가 입력 시 천 단위 콤마 자동 적용
- [ ] 수량 입력 시 자동 계산
- [ ] 기본세율/FTA 세율 비교 표시
- [ ] 절감액 정확히 계산되는지 확인

### 8.2 UI 테스트

- [ ] 탭 없이 단일 페이지 표시
- [ ] 모바일 반응형 레이아웃
- [ ] 비교 테이블 가독성
- [ ] 아이콘 정상 표시 (이모지 없음)

### 8.3 계산 검증

- [ ] FTA 포털과 관세율 비교
- [ ] 수동 계산 결과와 비교

---

## 9. 제약 사항

### 9.1 데이터 한계
- HS Code 데이터는 샘플 30개 품목 (추후 확장 필요)
- FTA 세율은 한중 FTA만 지원

### 9.2 계산 한계
- 배송비, 통관비 등 추가 비용 미포함
- 할당관세, 세율할당 등 특수 관세 미지원

---

## 10. 참고 자료

### 10.1 관련 문서
- exchange-calculator.md (환율 계산기 PRD)

### 10.2 외부 링크
- [관세청 FTA 포털](https://www.customs.go.kr/ftaportalkor/main.do)
- [공공데이터포털 HS Code](https://www.data.go.kr/data/15049722/fileData.do)
